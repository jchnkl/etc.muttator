"0.6 (created: 2010/06/29 23:32:30)

cmap        <silent> <C-n> <Down>
cmap        <silent> <C-p> <Up>

map         <silent> "\\b" :b#<Return>
nmap        <silent> "\\b" :b#<Return>

nnoremap    <silent> <C-n> gt
nnoremap    <silent> <C-p> gT

vmap <silent> "\\b" :b#<Return>

javascript << EOF

var aspectRatioClassic  = 9/10;
var aspectRatioVertical = 4/3;

function currentLayout() {
    // mozilla/comm-central/mail/base/content/mailWindowOverlay.js
    return gPrefBranch.getIntPref ( "mail.pane_config.dynamic" );
}

changeLayout = function () {

    if (    document.width / document.height >= aspectRatioVertical
         &&                  currentLayout() != kVerticalMailLayout )
    {
        // browser.dom.window.dump.enabled -> true
        dump ( "kVerticalMailLayout" + "\n" );
        dump ( aspectStringInfo() );
        ChangeMailLayout ( kVerticalMailLayout );

    } else if (    document.width / document.height >  aspectRatioClassic
         &&        document.width / document.height <  aspectRatioVertical
         &&                         currentLayout() != kClassicMailLayout )
    {
        // browser.dom.window.dump.enabled -> true
        dump ( "kClassicMailLayout" + "\n" );
        dump ( aspectStringInfo() );
        ChangeMailLayout ( kClassicMailLayout );


    } else if (    document.width / document.height <= aspectRatioClassic
                &&                  currentLayout() != kWideMailLayout )
    {
        // browser.dom.window.dump.enabled -> true
        dump ( "kWideMailLayout" + "\n" );
        dump ( aspectStringInfo() );
        ChangeMailLayout ( kWideMailLayout );

    } else {
        return;
    }

}

function aspectStringInfo() {
    return  "currentLayout:           " + currentLayout()        + "\n"
          + "document.width:          " + document.width         + "\n"
          + "document.height:         " + document.height        + "\n"
          + "window.screen.width:     " + window.screen.width    + "\n"
          + "window.screen.height:    " + window.screen.height   + "\n"
          +      document.width + " / " + document.height        + " = "
          +        document.width / document.height              + "\n"
          + window.screen.width + " / " + window.screen.height   + " = "
          +     window.screen.width / window.screen.height       + "\n";
}

removeEventListener ( "resize", changeLayout, false );
addEventListener    ( "resize", changeLayout, false );

EOF

autocmd MuttatorEnter .* -javascript changeLayout

" vim: set ft=muttator:
